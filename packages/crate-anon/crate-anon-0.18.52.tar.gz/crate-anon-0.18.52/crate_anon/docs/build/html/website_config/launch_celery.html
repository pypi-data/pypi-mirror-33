
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>8.7. Launch Celery &#8212; CRATE  documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/crate_docs.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8.8. CRATE Windows service" href="windows_service.html" />
    <link rel="prev" title="8.6. Configuring for Apache" href="apache.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="windows_service.html" title="8.8. CRATE Windows service"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="apache.html" title="8.6. Configuring for Apache"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CRATE  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">8. Configuring the CRATE web interface</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="launch-celery">
<h1>8.7. Launch Celery<a class="headerlink" href="#launch-celery" title="Permalink to this headline">¶</a></h1>
<p>When web sites want to do something slow, or spontaneously, they should not do
so within a user interaction. If the user says “build me a 1 Gb file for
download”, the web site shouldn’t build it and then provide it for download;
the user will think the site is unresponsive. Usually, it should reply
immediately to say “OK, working on that”, do the work, and then indicate to the
user somehow that the job is done. Similarly, web sites may need to act
spontaneously (e.g. do things at midnight every day).</p>
<p>The general method of doing this is to have a task queue. CRATE uses <a class="reference external" href="http://www.celeryproject.org/">Celery</a>
for its task queue. It creates Celery tasks when it wants to do something slow
(like checking consent modes and sending a bunch of e-mails).</p>
<p>In turn, Celery puts tasks into a message queue system, passing messages via
the <a class="reference external" href="https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol">AMQP</a> protocol. By default, the message broker is <a class="reference external" href="https://www.rabbitmq.com/">RabbitMQ</a>. It’s the job
of the broker to receive messages, keep them safe (so that they’re not lost if
the system is rebooted, for example), and to make them available to software
that needs them.</p>
<p>When a task is run, Celery will call back into the CRATE code to get the job
done, but using a different process from the one that responded to the user’s
initial HTTP request.</p>
<div class="section" id="crate-launch-celery">
<span id="id1"></span><h2>8.7.1. crate_launch_celery<a class="headerlink" href="#crate-launch-celery" title="Permalink to this headline">¶</a></h2>
<p>This launches the CRATE Celery system. You need this to be running for CRATE
to work properly. (See also <a class="reference internal" href="windows_service.html#windows-service"><span class="std std-ref">Windows service</span></a>.)</p>
<p>Options as of 2016-07-21:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>usage: crate_launch_celery [-h] [--command COMMAND] [--debug]

Launch CRATE Celery processes. (Any leftover arguments will be passed to
Celery.)

optional arguments:
  -h, --help         show this help message and exit
  --command COMMAND  Celery command (default: worker)
  --debug            Ask Celery to be verbose
</pre></div>
</div>
</div>
<div class="section" id="crate-celery-status">
<span id="id2"></span><h2>8.7.2. crate_celery_status<a class="headerlink" href="#crate-celery-status" title="Permalink to this headline">¶</a></h2>
<p>This executes the command <code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">-A</span> <span class="pre">crate_anon.crateweb.consent</span> <span class="pre">status</span></code>.</p>
</div>
<div class="section" id="crate-launch-flower">
<span id="id3"></span><h2>8.7.3. crate_launch_flower<a class="headerlink" href="#crate-launch-flower" title="Permalink to this headline">¶</a></h2>
<p>This command has no options. It launches the Celery <a class="reference external" href="http://flower.readthedocs.io/">Flower</a> tool, which is for
monitoring Celery. It starts a local web server (by default on port 5555; see
<a class="reference internal" href="../misc/tcpip_ports.html#tcpip-ports"><span class="std std-ref">TCP/IP ports</span></a>); if you browse to <a class="reference external" href="http://localhost:5555/">http://localhost:5555/</a> or
<a class="reference external" href="http://127.0.0.1:5555/">http://127.0.0.1:5555/</a>, you can see what’s happening on your Celery system.</p>
</div>
<div class="section" id="see-also">
<h2>8.7.4. See also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<p>If Celery jobs are taken out of the queue and then crash inside CRATE, you may
wish to resubmit unprocessed work. For this, use</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>crate_django_manage resubmit_unprocessed_tasks
</pre></div>
</div>
<p>See <a class="reference internal" href="django_manage.html#crate-django-manage"><span class="std std-ref">crate_django_manage</span></a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table Of Contents</a></h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/package_elements.html">2. Package elements in brief</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/publications.html">3. Reference publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.html">4. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/database_drivers.html">5. Databases and database drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../anonymisation/index.html">6. Anonymisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nlp/index.html">7. Natural language processing (NLP)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">8. Configuring the CRATE web interface</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="components.html">8.1. Web site components</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html">8.2. Configuring the web front end</a></li>
<li class="toctree-l2"><a class="reference internal" href="web_config_file.html">8.3. Web config file</a></li>
<li class="toctree-l2"><a class="reference internal" href="django_manage.html">8.4. Manage the CRATE web server</a></li>
<li class="toctree-l2"><a class="reference internal" href="launch_server.html">8.5. Launch the CRATE web server</a></li>
<li class="toctree-l2"><a class="reference internal" href="apache.html">8.6. Configuring for Apache</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">8.7. Launch Celery</a></li>
<li class="toctree-l2"><a class="reference internal" href="windows_service.html">8.8. CRATE Windows service</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../website_using/index.html">9. Using the CRATE web interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/ancillary_tools.html">10. Ancillary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/troubleshooting.html">11. Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/technical_notes.html">12. Technical notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/upgrading.html">13. Upgrading CRATE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/tcpip_ports.html">14. Common relevant TCP/IP ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../autodoc/index.html">15. Automatic documentation of source code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">16. Change log/history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../to_do.html">17. Things to do</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">18. Abbreviations and glossary</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="apache.html"
                        title="previous chapter">8.6. Configuring for Apache</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="windows_service.html"
                        title="next chapter">8.8. CRATE Windows service</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/website_config/launch_celery.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="windows_service.html" title="8.8. CRATE Windows service"
             >next</a> |</li>
        <li class="right" >
          <a href="apache.html" title="8.6. Configuring for Apache"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CRATE  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >8. Configuring the CRATE web interface</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Rudolf Cardinal.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pysap - Python library for crafting SAP’s network protocols packets &#8212; pysap 0.1.16 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="User guide" href="user/index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pysap-python-library-for-crafting-sap-s-network-protocols-packets">
<h1>pysap - Python library for crafting SAP’s network protocols packets<a class="headerlink" href="#pysap-python-library-for-crafting-sap-s-network-protocols-packets" title="Permalink to this headline">¶</a></h1>
<p>Version v0.1.16 (<a class="reference internal" href="user/index.html#installation"><span class="std std-ref">Installation</span></a>)</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.sap.com/platform/netweaver/index.epx">SAP Netweaver</a> and
<a class="reference external" href="https://www.sap.com/products/hana.html">SAP HANA</a> are technology platforms for
building and integrating SAP business applications. Communication between components
uses different network protocols and some services and tools make use of custom file
formats as well. While some of them are standard and well-known protocols, others
are proprietaries and public information is not available.</p>
<p><a class="reference external" href="https://www.coresecurity.com/corelabs-research/open-source-tools/pysap">pysap</a>
is an open source Python library that provides modules for crafting and sending packets
using SAP’s NI, Diag, Enqueue, Router, Message Server, SNC and IGS protocols. In addition,
support for creating and parsing different proprietary file formats is included. The
modules are built on top of <a class="reference external" href="http://www.secdev.org/projects/scapy/">Scapy</a> and are
based on information acquired at researching the different protocols, file formats
and services.</p>
</div>
<div class="section" id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Dissection and crafting of the following network protocols:</p>
<blockquote>
<div><ul class="simple">
<li>SAP Network Interface (NI)</li>
<li>SAP Diag</li>
<li>SAP Enqueue</li>
<li>SAP Router</li>
<li>SAP Message Server (MS)</li>
<li>SAP Secure Network Connection (SNC)</li>
<li>SAP Internet Graphic Server (IGS)</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Client interfaces for handling the following file formats:</p>
<blockquote>
<div><ul class="simple">
<li>SAP SAR archive files</li>
<li>SAP PSE (Personal Security Environment) files</li>
<li>SAP SSO Credential (Credv2) files</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Library implementing SAP’s LZH and LZC compression algorithms.</p>
</li>
<li><p class="first">Automatic compression/decompression of payloads with SAP’s algorithms.</p>
</li>
<li><p class="first">Client, proxy and server classes implemented for some of the protocols.</p>
</li>
<li><p class="first">Example scripts to illustrate the use of the different modules and protocols.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="content">
<h1>Content<a class="headerlink" href="#content" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="user/index.html">User guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user/index.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="user/index.html#installation-with-pip">Installation with pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="user/index.html#manual-installation">Manual installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="user/index.html#scapy-installation">Scapy installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user/index.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="protocols/index.html">Protocols</a><ul>
<li class="toctree-l2"><a class="reference internal" href="protocols/SAPDiag.html">SAP Diag</a><ul>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPDiag.html#SAP-Diag-DP-Header-packet">SAP Diag DP Header packet</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPDiag.html#SAP-Diag-packet">SAP Diag packet</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPDiag.html#SAP-Diag-Items">SAP Diag Items</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPDiag.html#SAP-Diag-APPL/APPL4-Items">SAP Diag APPL/APPL4 Items</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPDiag.html#SAP-Diag-Error-packet">SAP Diag Error packet</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="protocols/SAPEnqueue.html">SAP Enqueue</a><ul>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPEnqueue.html#SAP-Enqueue-packet">SAP Enqueue packet</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPEnqueue.html#SAP-Enqueue-Server-Admin-opcodes">SAP Enqueue Server Admin opcodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPEnqueue.html#SAP-Enqueue-Connection-Admin-opcodes">SAP Enqueue Connection Admin opcodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPEnqueue.html#SAP-Enqueue-Connection-Admin-parameters">SAP Enqueue Connection Admin parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="protocols/SAPIGS.html">SAP Internet Graphic Server (IGS)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPIGS.html#SAP-IGS-packet">SAP IGS packet</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPIGS.html#SAP-IGS-Table-packet">SAP IGS Table packet</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="protocols/SAPMS.html">SAP Message Server (MS)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPMS.html#SAP-Message-Server-packet">SAP Message Server packet</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPMS.html#SAP-Message-Server-packet-opcodes">SAP Message Server packet opcodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPMS.html#SAP-Message-Server-Client-packets">SAP Message Server Client packets</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPMS.html#SAP-Message-Server-stats-packets">SAP Message Server stats packets</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPMS.html#SAP-Message-Server-Logon-packet">SAP Message Server Logon packet</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPMS.html#SAP-Message-Server-Counter-packet">SAP Message Server Counter packet</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPMS.html#SAP-Message-Server-Adm-Record-opcodes">SAP Message Server Adm Record opcodes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="protocols/SAPNI.html">SAP NI (Network Interface)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPNI.html#SAP-NI-packet">SAP NI packet</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="protocols/SAPRFC.html">SAP RFC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPRFC.html#SAP-RFC-External-packets">SAP RFC External packets</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPRFC.html#SAP-RFC-Gateway-Monitor-packets">SAP RFC Gateway Monitor packets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="protocols/SAPRouter.html">SAP Router</a><ul>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPRouter.html#SAP-Router-Admin-packets">SAP Router Admin packets</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPRouter.html#SAP-Router-Error-Information-/-Control-packets">SAP Router Error Information / Control packets</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPRouter.html#SAP-Router-Route-packet">SAP Router Route packet</a></li>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPRouter.html#SAP-Router-Pong-packet">SAP Router Pong packet</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="protocols/SAPSNC.html">SAP SNC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="protocols/SAPSNC.html#SAP-SNC-Frame-packet">SAP SNC Frame packet</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fileformats/index.html">File formats</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fileformats/SAPCAR.html">SAP CAR</a><ul>
<li class="toctree-l3"><a class="reference internal" href="fileformats/SAPCAR.html#SAPCAR-Archive-version-2.00">SAPCAR Archive version 2.00</a></li>
<li class="toctree-l3"><a class="reference internal" href="fileformats/SAPCAR.html#SAPCAR-Archive-version-2.01">SAPCAR Archive version 2.01</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fileformats/SAPCredv2.html">SAP Credv2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="fileformats/SAPCredv2.html#Credv2-without-LPS">Credv2 without LPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="fileformats/SAPCredv2.html#Credv2-with-LPS">Credv2 with LPS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fileformats/SAPPSE.html">SAP PSE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="fileformats/SAPPSE.html#PSE-file">PSE file</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples/index.html">Example scripts</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">Developer Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/pysap.html">pysap package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/pysap.html#pysap">pysap</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/pysap.html#subpackages">Subpackages</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/pysap.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/pysapcompress.html">pysapcompress library</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dev/index.html">Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dev/changelog.html">Release and version history</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-16-2018-06-19">v0.1.16 - 2018-06-19</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-15-2018-03-27">v0.1.15 - 2018-03-27</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-14-2017-10-04">v0.1.14 - 2017-10-04</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-13-2017-02-16">v0.1.13 - 2017-02-16</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-12-1-2016-12-19">v0.1.12.1 - 2016-12-19</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-12-2016-12-16">v0.1.12 - 2016-12-16</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-11-2016-10-12">v0.1.11 - 2016-10-12</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-10-2016-03-25">v0.1.10 - 2016-03-25</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-9-2016-02-08">v0.1.9 - 2016-02-08</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-8-2015-10-29">v0.1.8 - 2015-10-29</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-7-2015-05-13">v0.1.7 - 2015-05-13</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-6-2015-03-25">v0.1.6 - 2015-03-25</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-5-2015-01-16">v0.1.5 - 2015-01-16</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-4-2014-03-25">v0.1.4 - 2014-03-25</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-3-2013-08-28">v0.1.3 - 2013-08-28</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-2-2012-09-27">v0.1.2 - 2012-09-27</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev/changelog.html#v0-1-1-2012-07-29">v0.1.1 - 2012-07-29</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dev/index.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev/index.html#notebooks">Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev/index.html#code-contributions">Code contributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev/index.html#bug-reporting">Bug reporting</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">pysap - Python library for crafting SAP’s network protocols packets</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#features">Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#content">Content</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
      <li>Next: <a href="user/index.html" title="next chapter">User guide</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2012-2018, Martin Gallo, Core Security.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
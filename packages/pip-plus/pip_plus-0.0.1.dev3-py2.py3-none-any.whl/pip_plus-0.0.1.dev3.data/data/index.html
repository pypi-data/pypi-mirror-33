<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>PIP Plus</title>
    <link rel="icon" href="/image/favicon.ico/?ImageType=png">
<link href="https://cdn.bootcss.com/bootstrap/4.1.1/css/bootstrap-grid.css" rel="stylesheet">
<link href="https://cdn.bootcss.com/bootstrap/4.1.1/css/bootstrap-grid.min.css" rel="stylesheet">
<link href="https://cdn.bootcss.com/bootstrap/4.1.1/css/bootstrap-reboot.css" rel="stylesheet">
<link href="https://cdn.bootcss.com/bootstrap/4.1.1/css/bootstrap-reboot.min.css" rel="stylesheet">
<link href="https://cdn.bootcss.com/bootstrap/4.1.1/css/bootstrap.css" rel="stylesheet">
<link href="css/jquery.loading.min.css" rel="stylesheet">
</head>
<body onunload="goodbye()">

<header>
  <div class="bg-dark collapse " id="navbarHeader" style="">
    <div class="container">
      <div class="row">
        <div class="col-sm-8 col-md-7 py-4">
          <h4 class="text-white">About</h4>
          <p class="text-muted">Add some information about the album below, the author, or any other background context. Make it a few sentences long so folks can pick up some informative tidbits. Then, link them off to some social networking sites or contact information.</p>
        </div>
        <div class="col-sm-4 offset-md-1 py-4">
          <h4 class="text-white">Contact</h4>
          <ul class="list-unstyled">
            <li><a href="#" class="text-white">Follow on Twitter</a></li>
            <li><a href="#" class="text-white">Like on Facebook</a></li>
            <li><a href="#" class="text-white">Email me</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="navbar navbar-dark bg-dark box-shadow">
    <div class="container d-flex justify-content-between">
      <a href="#" class="navbar-brand d-flex align-items-center">
        <svg  width="20" height="20" >
            <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-592.72335,-420.20756)">
    <g
       id="g4506"
       transform="translate(-67.857146,-23.035712)"
       inkscape:export-xdpi="98.922112"
       inkscape:export-ydpi="98.922112">
      <path
         inkscape:connector-curvature="0"
         id="path5201-0-9"
         fill="#f7f7f4"
         fill-opacity="1"
         stroke="#cccccc"
         stroke-width="0.35507631"
         stroke-linejoin="bevel"
         stroke-miterlimit="4"
         stroke-dasharray="none"
         d="m 660.75803,449.15562 15.55544,5.66172 15.78565,-5.74552 -15.55544,-5.66172 z" />
      <path
         inkscape:connector-curvature="0"
         id="path5203-3-8"
         fill="#ffffff"
         fill-opacity="1"
         stroke="#cccccc"
         stroke-width="0.35507631"
         stroke-linejoin="bevel"
         stroke-miterlimit="4"
         stroke-dasharray="none"
         d="m 676.31347,454.81734 0,18.28268 15.78565,-5.74551 0,-18.28269 z" />
      <path
         inkscape:connector-curvature="0"
         id="path5205-3-0"
         fill="#efeeea"
         fill-opacity="1"
         stroke="#cccccc"
         stroke-width="0.35507631"
         stroke-linejoin="bevel"
         stroke-miterlimit="4"
         stroke-dasharray="none"
         d="m 660.75803,449.15562 15.55544,5.66172 0,18.28268 -15.55544,-5.66171 z" />
    </g>
  </g>

        </svg>

<!--         <svg xmlns="/image/white-cube.svg/?ImageType=svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg> -->
<!--         <img alt="PyPI" src="/image/white-cube.svg/?ImageType=svg"> -->



        <strong>Pip Plus</strong>
      </a>


      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
            <a class="py-2 d-none d-md-inline-block"  href="https://www.lfd.uci.edu/~gohlke/pythonlibs/" target='_blank' >Christoph Gohlke’s page</a>
        </li>

      </ul>

      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a href="https://pypi.org/"  target='_blank' >https://pypi.org/</a>
        </li>

      </ul>

<ul class="navbar-nav mr-auto">
        <li class="nav-item">
<!-- <div class="input-group   ">
  <div class="input-group-prepend">
    <label class="input-group-text" for="inputGroupSelect01">修改源</label>
  </div>
  <select class="custom-select" id="inputGroupSelect01">
    <option selected>清华大学</option>
    <option value="1">豆瓣</option>
    <option value="2">阿里巴巴</option>
    <option value="3">Three</option>
  </select>

</div> -->
        </li>
</ul>

      

<!--       <button class="navbar-toggler collapsed " type="button" data-toggle="collapse" data-target="#navbarHeader" aria-controls="navbarHeader" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button> -->
    </div>
  </div>
</header>

<main role="main">


<div class="album py-5 bg-light">

<div class="container">


<h2>Pip Plus</h2>
<!-- <h4>您可以在这里安装查询更新卸载你的安装包，也可以备份和和生成对应的包</h4>
 -->
<h4>You can install the query update here to uninstall your installation package, or you can back up and generate the corresponding package.</h4>

<div class="bs-example" data-example-id="btn-variants">


<div class="input-group mb-3">
  <div class="input-group-prepend">
    <span class="input-group-text" id="basic-addon3">Package Name</span>
  </div>
  <input type="text" id="search_input" aria-describedby="basic-addon3">
  <div class="input-group-prepend">
    <span class="input-group-text" id="">Version(option)</span>
  </div>



  <input type="text" id="version_input" aria-describedby="basic-addon3">


<div class="input-group-append">
    <button id="search_btn"      class="btn btn-outline-secondary" type="button">Search in Pypi</button>
    <button id="get_package_btn" class="btn btn-outline-secondary" type="button">Find Project</button>
    <button id="install_btn"     class="btn btn-outline-secondary" type="button">Install</button>
    <button type="button" id="make_requirements_btn" target='_blank' class="btn btn-outline-secondary">make requirements</button>
</div>


<!-- <div class="input-group-prepend">
    <label class="input-group-text" for="inputGroupSelect01">Requement file</label>
  </div>


  <div class="custom-file">
    <input type="file" class="custom-file-input" id="inputGroupFile04">
    <label class="custom-file-label" for="inputGroupFile04">Choose file</label>
  </div>

 -->


</div>

<!-- <div class="input-group mb-3">
  <div class="input-group-append">

    <button id="batch_uninstall" class="btn btn-outline-secondary" type="button">批量卸载</button>
    <button id="batch_uninstall" class="btn btn-outline-secondary" type="button">批量升级</button>

  </div>


</div> -->



</div>

<div>
<!-- <div class="input-group mb-3">
  <div class="input-group-prepend">
    <span class="input-group-text" id="basic-addon3">Command</span>
  </div>
  <input type="" name="" placeholder="pip install Django" >


  <div class="input-group-append">
    <button type="button" id="command_btn" target='_blank' class="btn btn-outline-secondary">执行命令</button>
  </div>
  <div class="input-group-append">
    <button type="button" id="make_requirements_btn" target='_blank' class="btn btn-outline-secondary">生成 requirements</button>
  </div>
  <div class="input-group-append">
    <button type="button" id="start_cmd_btn" target='_blank' class="btn btn-outline-secondary">启动终端</button>
  </div>

</div>
 -->




<!-- Button trigger modal -->
<!-- <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
  Launch demo modal
</button>
 -->
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body row pre-scrollable" id="requirement_content" >

<table class="table table-hover ">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">Package Name</th>
      <th scope="col">Package Version</th>
    </tr>
  </thead>
  <tbody  id="requirement_table">
    <tr>
      <th scope="row">1</th>
      <td>Mark</td>
      <td>Otto</td>
    </tr>

  </tbody>
</table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Install</button>
      </div>
    </div>
  </div>
</div>





</div>






<!-- <div>
  <input type="file" id="files" style="display: none" onchange="fileImport();">
  <button type="button" id="fileImport" target='_blank' class="btn btn-primary btn-sm">打开文件</button>

    可以用拖拽上传的方法
</div>
 -->

<!-- 
<button type="button" id="list_btn" target='_blank' class="btn btn-primary btn-sm">list</button>

 -->





<!-- Button trigger modal -->

<!-- Modal -->
<div class="modal fade" id="package_info_Modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">More Detailed Information</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="info_body">
        ...
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>









<div class="row">
  <div class="col-3">
    <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
      <a class="nav-link active" id="v-pills-installed-tab" data-toggle="pill" href="#v-pills-home" role="tab" aria-controls="v-pills-home" aria-selected="true">Installed</a>
      <a class="nav-link" id="v-pills-outdated-tab" data-toggle="pill" href="#v-pills-profile" role="tab" aria-controls="v-pills-profile" aria-selected="false">Outdated</a>
<!--       <a class="nav-link" id="v-pills-messages-tab" data-toggle="pill" href="#v-pills-messages" role="tab" aria-controls="v-pills-messages" aria-selected="false">无需升级</a> -->
<!--       <a class="nav-link" id="v-pills-settings-tab" data-toggle="pill" href="#v-pills-settings" role="tab" aria-controls="v-pills-settings" aria-selected="false">无依赖关系</a> -->
<!--       <a class="nav-link" id="v-pills-settings-tab" data-toggle="pill" href="#v-pills-settings" role="tab" aria-controls="v-pills-settings" aria-selected="false">收藏</a> -->
    </div>
  </div>
  <div class="col-9">
    <div class="tab-content" id="v-pills-tabContent">
      <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel" aria-labelledby="v-pills-installed-tab">

        <table class="table" >
            <thead >
              <tr>
                <th>name</th>
                <th>version</th>
                <th>latest_version</th>
                <th>option</th>
<!--                 <th>location</th> -->
              </tr>
            </thead>
            <tbody id="installed_package">
        
            </tbody>
        </table>



      </div>
      <div class="tab-pane fade" id="v-pills-profile" role="tabpanel" aria-labelledby="v-pills-outdated-tab">

        <table class="table">
            <thead >
              <tr>
                <th  >name</th>
                <th  >version</th>
                <th  >latest_version</th>
                <th  >option</th>
<!--                 <th>location</th> -->
              </tr>
            </thead>
            <tbody id="outdated_package">
        
            </tbody>
        </table>
        
      </div>
      <div class="tab-pane fade" id="v-pills-messages" role="tabpanel" aria-labelledby="v-pills-messages-tab">...</div>
      <div class="tab-pane fade" id="v-pills-settings" role="tabpanel" aria-labelledby="v-pills-settings-tab">...</div>
    </div>
  </div>
</div>

</div>

</div>

</main>




<footer class="text-muted">
  <div class="container">
    <p class="float-right">
      <a href="#">Back to top</a>
    </p>
    <p>Power by huohongming</p>
    <p>New to Pip Plus? <a href="https://hmhuo.github.io/" target="_blank">Visit the homepage</a> or read our <a href="../../getting-started/">getting started guide</a>.</p>
  </div>
</footer>



<!-- <footer class="text-muted">
  <div class="container">
    <p class="float-right">
      <a href="#">Back to top</a>
    </p>
    <p>Album example is © Bootstrap, but please download and customize it for yourself!</p>
    <p>New to Bootstrap? <a href="../../">Visit the homepage</a> or read our <a href="../../getting-started/">getting started guide</a>.</p>
  </div>
</footer>
 -->




<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/4.1.1/js/bootstrap.bundle.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="/script/jquery.loading.min.js"></script>
<script>
  
// var package_list = [{'location': 'c:\\users\\gin\\appdata\\local\\programs\\python\\python35\\lib\\site-packages', 'installer': '', 'version': '0.2.0', 'name': 'absl-py'},
// {'location': 'c:\\users\\gin\\appdata\\local\\programs\\python\\python35\\lib\\site-packages', 'installer': 'pip', 'version': '0.3.2', 'name': 'aiofiles'},
// {'location': 'c:\\users\\gin\\appdata\\local\\programs\\python\\python35\\lib\\site-packages', 'installer': 'pip', 'version': '4.4.3', 'name': 'zope.interface'}];




var local_package_list = new Array()


function list_package(package_list,package_table)
{

  var tr_date = null;
  for (var i = 0; i < package_list.length; i++) {



    //查找 有没有 名字 一样的  有名字


    var package_info  = package_list[i];
    var td_option     = ""

    var info_btn      = "<button type=\"button\"  value=\""+package_info["name"]+"\" data-toggle=\"modal\" data-target=\"#package_info_Modal\"  class=\"btn btn-outline-info btn-sm\">Info</button>";
    var uninstall_btn = "<button type=\"button\"  value=\""+package_info["name"]+"\"   class=\"btn btn-outline-danger btn-sm\">Uninstall</button>"

    var td_checkbox =   "<td><div class=\"custom-control custom-checkbox\">\
        <input type=\"checkbox\" class=\"custom-control-input\" id=\"customCheck"+i+"\">\
        <label class=\"custom-control-label\" for=\"customCheck"+i+"\">   <br></label>\
      </div></td>"

    td_checkbox ="";

    if (package_info["latest_version"]  == undefined)
    {
      package_info["latest_version"] ="";
    }
    
    if ((package_info["name"] == "pip" )|| (package_info["name"] == "setuptools"))
    {
      td_option = "<td  option=\""+package_info["name"]+"\"  >"+info_btn+"</td>";
    }
    else
    {
      td_option = "<td option=\""+package_info["name"]+"\" >"+info_btn+uninstall_btn+"</td>";
    }


    tr_date = tr_date +"<tr>"
    +"<td><a   target='_blank' href=\"https://pypi.org/project/"+package_info["name"]+"/\">"+package_info["name"]+"</a></td>"
    +"<td>"+package_info["version"]+"</td>"
    +"<td option1=\""+package_info["name"]+"\">"+package_info["latest_version"]+"</td>"
    +td_option
    +td_checkbox
    // +"<td>"+package_info["location"]+"</td>"
    +"</tr>"
  }

  // $("#installed_package").append(tr_date);
  $("#"+package_table).append(tr_date);

// installed_package
// outdated_package
  register_install();


}




function list_outdated_package(package_list)
{

// <tr><td>pip</td><td>9.0.3</td><td>10.0.1</td></tr>

  var tr_date = null;
  for (var i = 0; i < package_list.length; i++) {
    var package_info = package_list[i];

    // $("tr:contains("+package_info["name"]+")").find("td")[2].append(package_info["latest_version"]);
    // $("tr:contains("+package_info["name"]+")").find("td")[3].text("<button type=\"button\"  value=\""+package_info["name"]+"\"   class=\"btn btn-outline-primary btn-sm\">升级</button>");

    // $("tr:contains("+package_info["name"]+")").find("td")[3].remove();
    // $("tr:contains("+package_info["name"]+")").find("td")[2].after("<td><button type=\"button\"  value=\""+package_info["name"]+"\"   class=\"btn btn-outline-primary btn-sm\">升级</button></td>");

    $("td[option=\""+package_info["name"]+"\"]").append("<button type=\"button\"  value=\""+package_info["name"]+"\"   class=\"btn btn-outline-primary btn-sm\">升级</button>");


    $("td[option1=\""+package_info["name"]+"\"]").html(package_info["latest_version"]);

    console.log($("td[value=\""+package_info["name"]+"-option\"]"))
    // $("tr:contains("+package_info["name"]+")").find("td")[3].append('<button type=\"button\" value=\"Django\" class=\"btn btn-outline-danger btn-sm\">卸载</button>')
  }
  // $("#outdated_package").append(tr_date);
  // $("tbody").append(tr_date);
  // $("#option2").parent().text("")
  // console.log($("#option2").next());
  // $("#option2").after('Some text')

 // $("a:contains(Outdated)").html("Outdated<span class=\"badge  badge-success\">"+package_list.length+"</span>");

  register_update();

}





$("#search_btn").click(function(event) {
  /* Act on the event */
  // console.log($("#search_input").val(),count);
  // count=count+1;
  // location.href = "https://pypi.org/search/?q="+$("#search_input").val();
  window.open("https://pypi.org/search/?q="+$("#search_input").val());
});


$("#get_package_btn").click(function(event) {




  window.open("https://pypi.org/project/"+$("#search_input").val()+"/");

});






$('#search_input').bind('keypress',function(event){  
 
  if(event.keyCode == "13")      
  {
    window.open("https://pypi.org/search/?q="+$("#search_input").val());
  }
});




$(document).ready(function($) {

  body_loading('Loading...');

  $.post('', "{\"list\": \"local\",\"type\":\"list\"}", function(data, textStatus, xhr) {
    /*optional stuff to do after success */
    // installed_package
// outdated_package
    list_package($.parseJSON(data.package_list),"installed_package");
    // $("a:contains(Installed)").html("Installed<span class=\"badge badge-light badge-dark\">"+$.parseJSON(data.package_list).length+"</span>");
    $("#v-pills-installed-tab").html("Installed<span class=\"badge badge-light badge-dark\">"+$.parseJSON(data.package_list).length+"</span>");
    
  });

  $.post('', "{\"list\": \"outdated\",\"type\":\"list\"}", function(data, textStatus, xhr) {
    /*optional stuff to do after success */
    // list_package($.parseJSON(data.package_list),"installed_package");
    list_package($.parseJSON(data.package_list),"outdated_package");
    list_outdated_package($.parseJSON(data.package_list));

    //$("a:contains(Installed)").html("Installed<span class=\"badge badge-light badge-dark\">"+data.package_list.length+"</span>");
    //$("a:contains(Outdated)").html("Outdated<span class=\"badge  badge-success\">"+$.parseJSON(data.package_list).length+"</span>");
    $("#v-pills-outdated-tab").html("Outdated<span class=\"badge  badge-success\">"+$.parseJSON(data.package_list).length+"</span>");

    body_loading_stop();

  });

  

});




//点击导入按钮,使files触发点击事件,然后完成读取文件的操作
$("#fileImport").click(function () {
  $("#files").click();
})
function fileImport() {
  //获取读取我文件的File对象
  var selectedFile = document.getElementById('files').files[0];
  var name = selectedFile.name;//读取选中文件的文件名
  var size = selectedFile.size;//读取选中文件的大小
  var path = selectedFile.value;//读取选中文件的大小
  console.log("文件名:"+name+"大小:"+size+"路径:"+path);
  var reader = new FileReader();//这是核心,读取操作就是由它完成.
  //reader.readAsText(selectedFile);//读取文件的内容,也可以读取文件的URL
  reader.onload = function () {
      //当读取完成后回调这个函数,然后此时文件的内容存储到了result中,直接操作即可
      console.log(this.result);
  }
}



$("#install_btn").click(function(event) {
  /* Act on the event */
  // console.log($("#search_input").val());

  body_loading('Installing，Please Wait a second...');

  $.post('', "{\"package_name\": \""+$("#search_input").val()+"\",\"type\":\"install\",\"version\":\""+$("#version_input").val()+"\"}", function(data, textStatus, xhr) {
    /*optional stuff to do after success */
    // $("#search_input").val()
    console.log(data, textStatus, xhr);

    if(data["state"]==true)
    {
      body_loading_stop();
      alert("Install Complated");
      window.location.reload();

    }






  });


});



$("#info_btn").click(function(event) {
  /* Act on the event */
  $.post('',  "{\"package_name\": \"django\",\"type\":\"info\"}", function(data, textStatus, xhr) {
    /*optional stuff to do after success */
    // console.log(data);
    var info_body = "";
    $("#info_body").empty();
    package_info=data.package_info
    for (var i in package_info) { 
      console.log(i + ": " + package_info[i]);
      if( i== "Home-page")
      {
        info_body = info_body + "<div>"+i+":<a   target='_blank' href=\""+package_info[i]+"\">"+package_info[i]+"</a></div>"  
      }
      else if( i== "Name")
      {//https://pypi.org/project/Django/
        info_body = info_body + "<div>"+i+":<a   target='_blank' href=\"https://pypi.org/project/"+package_info[i]+"/\">"+package_info[i]+"</a></div>"  
      }
      else
      {
        info_body = info_body + "<div>"+i+":"+package_info[i]+"</div>"  
      }
      

    }
    $("#info_body").append(info_body);
  });
});

// $("#list_btn").click(function(event) {
//   /* Act on the event */

//   $.post('', {list: 'local'}, function(data, textStatus, xhr) {
//     /*optional stuff to do after success */
//     list_package($.parseJSON(data.package_list));
//   });




//   $.post('', {list: 'outdated'}, function(data, textStatus, xhr) {
//     /*optional stuff to do after success */
//     list_package($.parseJSON(data.package_list));
//   });



// });

function register_update()
{
  $(".btn-outline-primary").click(function(event) {
  /* Act on the event */

      body_loading('Updating...');
    $.post('', "{\"package_name\": \""+$(this).val()+"\",\"type\":\"update\",\"version\":\"1.11\"}", function(data, textStatus, xhr) {
      /*optional stuff to do after success */
      body_loading_stop();
      alert("Update Complated");
      window.location.reload();
    });

  });
}


function body_loading(show_message)
{
  $("body").loading({
    stoppable: false,
    message: show_message,
    theme: 'dark'
  });
}

function body_loading_stop()
{
  $('body').loading('stop');
  $("body").removeAttr("onunload");
}




function register_install()
{

  $(".btn-outline-danger").click(function(event) {
  /* Act on the event */
    // console.log($(this).val());


    body_loading('Uninstalling...');
    $.post('', "{\"package_name\": \""+$(this).val()+"\",\"type\":\"uninstall\"}", function(data, textStatus, xhr) {
      /*optional stuff to do after success */
      body_loading_stop();
      alert("Uninstall Complated");
      window.location.reload();

    });

  });


  $(".btn-outline-info").click(function(event) {
    /* Act on the event */

    $("#info_body").empty();
    $.post('',  "{\"package_name\": \""+$(this).val()+"\",\"type\":\"info\"}", function(data, textStatus, xhr) {
      /*optional stuff to do after success */
      // console.log(data);
      var info_body = "";
      $("#info_body").empty();
      package_info=data.package_info
      for (var i in package_info) { 
        // console.log(i + ": " + package_info[i]);
        if( i== "Home-page")
        {
          info_body = info_body + "<div>"+i+":<a   target='_blank' href=\""+package_info[i]+"\">"+package_info[i]+"</a></div>"  
        }
        else if( i== "Name")
        {//https://pypi.org/project/Django/
          info_body = info_body + "<div>"+i+":<a   target='_blank' href=\"https://pypi.org/project/"+package_info[i]+"/\">"+package_info[i]+"</a></div>"  
        }
        else if ( i== "commmand_list")
        {
          
          
        }
        else if ( i== "Classifiers")
        {

        }
        else
        {
          info_body = info_body + "<div>"+i+":"+package_info[i]+"</div>"  
        }
      }



      if (package_info["commmand_list"].length>0)
      {
        var commmand_list  = package_info["commmand_list"];
        var commmand_table = ""
        var count          = 0;
        for (var i = commmand_list.length - 1; i >= 0; i--) {
          var commmand_info = commmand_list[i];
          // commmand_info["description"]  =
          // commmand_info["name"]         =
          // console.log(commmand_info);
          commmand_table = commmand_table + "<tr><td scope=\"row\">"+commmand_info["name"]+"</td>"+
            "<td>"+commmand_info["description"]+"</td></tr>"
      
            count = count +1
      
      
          
        }
      
        info_body = info_body + "<table class=\"table table-hover\"><thead><th scope=\"col\">command name</th><th scope=\"col\">description</th></tr></thead><tbody>"+        commmand_table+"</tbody>"
      }
      





      $("#info_body").append(info_body);




    });
  });




  $("#batch_uninstall").click(function(event) {
    /* Act on the event */
    $("input[type='checkbox']").attr("checked","checked");
    $("input[type='checkbox']")[0].attr("checked","checked");

  });



}

window.onbeforeunload=function(e){     
　　var e = window.event||e;  
　　e.returnValue=("确定离开当前页面吗？");
} 






$("#make_requirements_btn").click(function(event) {
  /* Act on the event */





    $.post('', "{\"type\":\"get_freeze\"}", function(data, textStatus, xhr) {
      /*optional stuff to do after success */


      console.log(data);
      var requirements_text = ""

      for (var i = 0; i < data.length; i++) {
        requirements_text = requirements_text  +  data[i] +"\r\n"
      }

      console.log(requirements_text)
      download_text("requirements.txt",requirements_text)

    });





});





function download_text(filename, text) {
    var pom = document.createElement('a');
    pom.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
    pom.setAttribute('download', filename);
    if (document.createEvent) {
        var event = document.createEvent('MouseEvents');
        event.initEvent('click', true, true);
        pom.dispatchEvent(event);
    } else {
        pom.click();
    }
}



$("#read_inputfile").click(function(event) {
  /* Act on the event */
  read_file();
});


function read_file()
{
  var file = document.getElementById("inputGroupFile04").files[0];
  var reader = new FileReader();
  reader.readAsText(file, "gbk");

  // console.log(file);
  reader.onload = function(){
      //读取完毕后输出结果

      // console.log(this.result);
      load_text_file(this.result);

  }
}


function load_text_file(file_content)
{
      console.log(typeof(file_content));
      console.log(file_content.length);


      if (file_content.length<=0)
      {
        alert("error file");
        return 0;
      }

      var requirement_content = ""
      var line  = "";
      var count = 1;
      for (var i = 0; i < file_content.length; i++) {

        if (file_content[i] == "\n")
        {
          console.log(line);
          var package_lenght = line.indexOf("==");
          if(package_lenght<=0)
          {
            alert("error file");
            return 0;
            break;
          }
          else
          {

            // https://pypi.org/project/django/
            // "<a href=\"https://pypi.org/project/"++"\"></a>"
            var package_name    = line.substring(0,package_lenght);
            var package_version = line.substring(package_lenght+2,line.length);

            line = "<tr><th scope=\"row\">"+count+"</th>"+
              "<td><a href=\"https://pypi.org/project/"+package_name+"\"  target=\"_blank\">"+package_name+"</a></td>"+
              "<td>"+package_version+"</td></tr>"

              count = count +1
            //line = "<a href=\"https://pypi.org/project/"+package_name+"\"  target=\"_blank\">"+package_name+"</a>=="+package_version+"<br>"
          }

          requirement_content = requirement_content + line;
          line = "";
        }
        else
        {
          line = line + file_content[i];
        }
      }



      $("#requirement_table").empty()
      // $("#requirement_content").append(requirement_content)
      $("#requirement_table").append(requirement_content)
      $('#package_info_Modal').modal('show');
}




$('#inputGroupFile04').on('change', function(){
    read_file();
    $(this).closest('form').submit();
});



/*拖拽的目标对象------ document 监听drop 并防止浏览器打开客户端的图片*/
document.ondragover = function (e) {
    e.preventDefault();  //只有在ondragover中阻止默认行为才能触发 ondrop 而不是 ondragleave
};
document.ondrop = function (e) {
    e.preventDefault();  //阻止 document.ondrop的默认行为  *** 在新窗口中打开拖进的图片
};
/*拖拽的源对象----- 客户端的一张图片 */
/*拖拽目标对象-----div#container  若图片释放在此元素上方，则需要在其中显示*/
inputGroupFile04.ondragover = function (e) {
    e.preventDefault();
};
inputGroupFile04.ondrop = function (e) {

  console.log(e.dataTransfer);
//        chrome 此处的显示有误
  var list = e.dataTransfer.files;
  for (var i = 0; i < list.length; i++) {
    var f = list[i];
//  console.log(f);
    reader(f);
// 读取指定文件的内容 作为“数据URL”
// reader.readAsDataURL(f);
// 当客户端文件读取完成 触发onload事件
  }
};
function reader(f) {
  var reader = new FileReader();
  reader.readAsText(f, "gbk");
  //reader.readAsDataURL(f);
  reader.onload = function () {
      // console.log(reader.result);
      // var img = new Image();
      // img.src = reader.result;
      // container.appendChild(img);
      load_text_file(this.result);
  }
}
    

$("#test_1").click(function(event) {
  /* Act on the event */
  $('#exampleModal').modal('show');
});




$("#start_cmd_btn").click(function(event) {
  /* Act on the event */
  $.post('', "{\"type\":\"terminal\"}", function(data, textStatus, xhr) {
    /*optional stuff to do after success */

    console.log(data);


  });


});


</script>



</body>
</html>
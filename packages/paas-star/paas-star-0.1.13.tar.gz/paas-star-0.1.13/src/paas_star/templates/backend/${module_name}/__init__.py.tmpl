import typing

from random import choice
from functools import partial
from archsdk import get_service
from star_builder import Component
from paas_star.backend import Manager

from .{{module_name}} import {{class_name}}


{{class_name}}Manger = typing.NewType("{{class_name}}Manger", Manager)


class {{class_name}}ManagerComponent(Component):

    def callback(self):
        return choice(get_service("{{name}}"))

    def resolve(self) -> {{class_name}}Manger:
        return {{class_name}}Manger(Manager(partial({{class_name}}.from_etcd, self.callback)))


class {{class_name}}Component(Component):

    def resolve(self) -> {{class_name}}:
        return {{class_name}}(**choice(get_service("{{name}}")))

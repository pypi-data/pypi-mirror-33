import os
import sys
import logging

from uvicorn import run
from star_builder import Application

from archsdk import register

app_name = "{{name}}"

level = os.getenv("PAAS_LOG_LEVEL", "DEBUG")
logging.basicConfig(level=logging._nameToLevel[level])
app = Application(
    app_name, current_dir=os.path.dirname(os.path.abspath(__file__)))

if os.getenv("NO_REGISTER", "False") in ["0", "False", "false"]:
    register(service_name=os.getenv("PAAS_APP_NAME", app_name))

if __name__ == "__main__":
    run(app, host="0.0.0.0", port=5678)

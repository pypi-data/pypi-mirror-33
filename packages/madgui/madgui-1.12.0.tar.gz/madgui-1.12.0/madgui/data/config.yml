# This is the default config file for madgui. The file format is YAML, which
# is fairly intuitive to read and write. To customize settings you should NOT
# modify this file, but rather put your values in a separate config file in
# $HOME/.madgui/config.yml (or %USER%\.madgui\config.yml). The values from
# both files will be merged.
#
# NOTE: Use lower-case keys, unless there is a special reason.

number:
  fmtspec: .4g
  spinbox: true

printoptions:           # numpy.set_printoptions in python shell
  precision: 5
  suppress: True        # no scientific notation
  linewidth: 120

mainwindow:
  init_size: [1000, 300]
  init_pos:  [   0,   0]

plot_windows:
  - name: envelope
    size: null
    pos: null

online_control:
  connect: false
  monitors: {}
  offsets: {}

logging:
  enable: true
  level: info
  madx:
    in: true
    out: false

onload: ""
model_path: ""
load_default: ""
exec_folder: ""
str_folder: ""

monitors: {}

# Settings for beam line and TWISS function display (component.TwissView and
# subcomponents):
line_view:

  # Plot style for the element indicators. Supports common keyword arguments
  # for ``matplotlib.axes.Axes.axvspan`` and ``matplotlib.axes.Axes.axvline``:
  element_style:
    quadrupole:   {                  ymin: 0.3, ymax: 0.7}
    sbend:        {color: "#ccccaa", ymin: 0.25, ymax: 0.75}
    solenoid:     {color: "#555555", ymin: 0.1, ymax: 0.9}
    multipole:    {color: "#00aa00", ymin: 0.1, ymax: 0.9}
    hkicker:      {color: "#bb0088", ymin: 0.2, ymax: 0.8}
    vkicker:      {color: "#8800bb", ymin: 0.2, ymax: 0.8}
    monitor:      {color: "#00bb00", ymin: 0.0, ymax: 1.0,
                   linestyle: dashed, linewidth: 1}
    hmonitor:     {color: "#00bb00", ymin: 0.0, ymax: 1.0,
                   linestyle: dashed, linewidth: 1}
    vmonitor:     {color: "#00bb00", ymin: 0.0, ymax: 1.0,
                   linestyle: dashed, linewidth: 1}

  # Style for the constraint markers. Can contain any keyword arguments to
  # ``matplotlib.axes.Axes.plot()``:
  constraint_style:
    marker: "o"
    fillstyle: "full"
    markersize: 12
    color: "yellow"
    zorder: 1

  # Style for the selected element markers. Can contain any keyword
  # arguments to ``matplotlib.axes.axvline()``:
  select_style:
    color: "#000000"
    ymin: 0
    ymax: 1

  # Style for the reference curve. Can contain any keyword arguments to
  # ``motplotlib.axes.Axes.plot()``
  reference_style:
    linestyle: "-"
    color: "black"

  # Style for monitor markers:
  monitor_style:
    marker: +
    fillstyle: full
    markersize: 12
    markeredgewidth: 1.5
    color: orange
    zorder: 2
    linestyle: none

  curve_style:
    - &base_style
      color: "#8b1a0e"
      linestyle: "-"
    - <<: *base_style
      color: "#005000"

  default_graph: envelope


graphs:
  beta:
    title: Beta function
    curves:
      - [betx, '$\beta x$']
      - [bety, '$\beta y$']
  envelope:
    title: Beam envelope
    curves:
      - [envx, '$\Delta x$']
      - [envy, '$\Delta y$']
  alpha:
    title: Alpha function
    curves:
      - [alfx, '$\alpha x$']
      - [alfy, '$\alpha y$']
  gamma:
    title: Gamma function
    curves:
      - [gamx, '$\gamma x$']
      - [gamy, '$\gamma y$']
  orbit:
    title: Particle orbit
    curves:
      - [x, '$x$']
      - [y, '$y$']
  momentum:
    title: Particle momentum
    curves:
      - [px, '$px$']
      - [py, '$py$']
  dispersion:
    title: Dispersion
    curves:
      - [dx, '$dx$']
      - [dy, '$dy$']
  momentum_dispersion:
    title: Momentum dispersion
    curves:
      - [dpx, '$dpx$']
      - [dpy, '$dpy$']
  phase:
    title: Phase advance
    curves:
      - [mux, '$\mu x$']
      - [muy, '$\mu y$']
  emittance:
    title: Emittanz
    curves:
      - [ex, '$\epsilon x$']
      - [ey, '$\epsilon y$']


# Select which element paramters can be varied when matching a TWISS function:
matching:
  # TODO: fill in more rules
  betx:     [quadrupole]
  bety:     [quadrupole]
  alfx:     [quadrupole]
  alfy:     [quadrupole]
  sig11:    [quadrupole]
  sig33:    [quadrupole]
  sig12:    [quadrupole]
  sig22:    [quadrupole]
  sig34:    [quadrupole]
  sig43:    [quadrupole]
  x:        [quadrupole,sbend,kicker,hkicker]
  y:        [quadrupole,sbend,kicker,vkicker]
  px:       [quadrupole,sbend,kicker,hkicker]
  py:       [quadrupole,sbend,kicker,vkicker]


parameter_sets:
  twiss_args:
    params: [
      # TODO:
      # - exclude more parameters (for most of these parameters, I actually
      #   don't know whether it makes sense to include them here)
      # - for excluded parameters show info string
      # - dynamically determine better default values
      betx: 0,    bety: 0,
      alfx: 0,    alfy: 0,
      mux:  0,    muy:  0,
      x:    0,    y:    0,
      t:    0,
      pt:   0,
      px:   0,    py:   0,
      dpx:  0,    dpy:  0,
      wx:   0,    wy:   0,
      phix: 0,    phiy: 0,
      dmux: 0,    dmuy: 0,
      ddx:  0,    ddy:  0,
      ddpx: 0,    ddpy: 0,
      r:      [[0, 0],
               [0, 0]],
      energy: 0,
      chrom:  True,
      file:   "",
      save:   "",
      table:  "twiss",
      beta0:  "",
      re:     [[1, 0, 0, 0, 0, 0],
               [0, 1, 0, 0, 0, 0],
               [0, 0, 1, 0, 0, 0],
               [0, 0, 0, 1, 0, 0],
               [0, 0, 0, 0, 1, 0],
               [0, 0, 0, 0, 0, 1]],
      centre:       True,
      ripken:       True,
      sectormap:    True,
      sectortable:  "",
      sectorfile:   "sectormap",
      rmatrix:      True,
    # sequence:     "",         # line/sequence is passed by madgui
    # line:         "",         # line/sequence is passed by madgui
    # range:        "",         # range is passed by madgui
      useorbit:     "",
      keeporbit:    "",
      tolerance:    0,
      deltap:       "",
    # notable:      True,       # madgui always needs table
    ]

  beam:
    params: [
      particle: "positron",
    # sequence: "",             # line/sequence is passed by madgui
      bunched:  True,
      radiate:  True,
      mass:     1,      # TODO: default is actually 'emass'
      charge:   1,
      energy:   1,
      pc:       0,
      gamma:    0,
      ex:       1,      ey:     1,
      exn:      0,      eyn:    0,
      et:       1,
      sigt:     0,
      sige:     0,
      kbunch:   1,
      npart:    1,
      bcurrent: 0,
      freg0:    0,
      circ:     0,
      dtbyds:   0,
      deltap:   0,
      beta:     0,
      alfa:     0,
      u0:       0,
      qs:       0,
      arad:     0,
      bv:       1,
    # pdamp:    [1, 1, 2],
      n1min:    -1,
    ]

  globals:
    params: []

  element:
    readonly: [name, base_name, node_name, position, length, s, index]
    params: []
    show:
      common:       [name, base_name, index, position, length]
      srotation:    [angle]
      solenoid:     [ks]
      multipole:    [knl, ksl, tilt]
      sbend:        [angle, kick, e1, e2, tilt]
      quadrupole:   [k1, k1s, tilt]
      collimator:   [apertype, aperture]
      hkicker:      [kick, tilt]
      vkicker:      [kick, tilt]
      kicker:       [hkick, vkick, tilt]

  twiss:
    params: [
      alfx: 0,
      alfy: 0,
      betx: 1,
      bety: 1,
    ]

  sigma:
    params: []

  sector:
    params: []

constraints: [
  betx, alfx, mux,
  bety, alfy, muy,
  x, px,
  y, py,
  t, pt,
  dx, dpx,
  dy, dpy,
  wx, phix, dmux,
  wy, phiy, dmuy,
  ddx, ddpx,
  ddy, ddpy,
  r11, r12,
  r21, r22,
  energy,
  mvar1, mvar2,
  mvar3, mvar4,
  re11, re12, re13, re14, re15, re16,
  re21, re22, re23, re24, re25, re26,
  re31, re32, re33, re34, re35, re36,
  re41, re42, re43, re44, re45, re46,
  re51, re52, re53, re54, re55, re56,
  re61, re62, re63, re64, re65, re66,
  alfa,
  beta11, alfa11, mu1,
  beta22, alfa22, mu2,
  beta33, alfa33, mu3,
  disp1, disp2, disp3, disp4,
  beta0,
]

{"version":3,"sources":["core/properties.ts"],"names":[],"mappings":"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","file":"properties.js","sourcesContent":["import {Signal0, Signal, Signalable} from \"./signaling\"\nimport {HasProps} from \"./has_props\"\nimport * as enums from \"./enums\"\nimport {Arrayable} from \"./types\"\nimport {is_svg_color} from \"./util/svg_colors\"\nimport {valid_rgb} from \"./util/color\"\nimport {includes, repeat} from \"./util/array\"\nimport {map} from \"./util/arrayable\"\nimport {isBoolean, isNumber, isString, isArray, isObject} from \"./util/types\"\n//import {Transform} from \"../models/transforms/transform\"\nimport {ColumnarDataSource} from \"../models/sources/columnar_data_source\"\n\nSignal; // XXX: silence TS, because `Signal` appears in declarations due to Signalable\n\nfunction valueToString(value: any): string {\n  try {\n    return JSON.stringify(value)\n  } catch {\n    return value.toString()\n  }\n}\n\nexport function isSpec(obj: any): boolean {\n  return !(obj instanceof HasProps) && isObject(obj) &&\n          ((obj.value === undefined ? 0 : 1) +\n           (obj.field === undefined ? 0 : 1) +\n           (obj.expr  === undefined ? 0 : 1) == 1) // garbage JS XOR\n}\n\n//\n// Property base class\n//\n\nexport class Property<T> extends Signalable() {\n\n  spec: {\n    value?: any\n    field?: string\n    expr?: any\n    transform?: any // Transform\n    units?: any\n  }\n\n  optional: boolean = false\n\n  dataspec: boolean // prototype\n\n  // XXX: restore constructor properties when https://github.com/Microsoft/TypeScript/issues/21954\n  //      is fixed (probably in TypeScript 2.8)\n  readonly obj: HasProps\n  readonly attr: string\n  readonly default_value?: (obj: HasProps) => T\n\n  readonly change: Signal0<HasProps>\n\n  constructor(obj: HasProps,\n              attr: string,\n              default_value?: (obj: HasProps) => T) {\n    super()\n    this.obj = obj\n    this.attr = attr\n    this.default_value = default_value\n    this.change = new Signal0(this.obj, \"change\")\n    this._init()\n    this.connect(this.change, () => this._init())\n  }\n\n  update(): void {\n    this._init()\n  }\n\n  // ----- customizable policies\n\n  init(): void {}\n\n  transform(values: any): any {\n    return values\n  }\n\n  validate(_value: any): void {}\n\n  // ----- property accessors\n\n  value(do_spec_transform: boolean = true): any {\n    if (this.spec.value === undefined)\n      throw new Error(\"attempted to retrieve property value for property without value specification\")\n    let ret = this.transform([this.spec.value])[0]\n    if (this.spec.transform != null && do_spec_transform)\n      ret = this.spec.transform.compute(ret)\n    return ret\n  }\n\n  array(source: ColumnarDataSource): any[] {\n    if (!this.dataspec)\n      throw new Error(\"attempted to retrieve property array for non-dataspec property\")\n\n    let ret: any\n\n    if (this.spec.field != null) {\n      ret = this.transform(source.get_column(this.spec.field))\n      if (ret == null)\n        throw new Error(`attempted to retrieve property array for nonexistent field '${this.spec.field}'`)\n    } else if (this.spec.expr != null) {\n      ret = this.transform(this.spec.expr.v_compute(source))\n    } else {\n      let length = source.get_length()\n      if (length == null)\n        length = 1\n      const value = this.value(false) // don't apply any spec transform\n      ret = repeat(value, length)\n    }\n\n    if (this.spec.transform != null)\n      ret = this.spec.transform.v_compute(ret)\n    return ret\n  }\n\n  // ----- private methods\n\n  /*protected*/ _init(): void {\n    const obj = this.obj\n    const attr = this.attr\n    let attr_value: any = obj.getv(attr)\n\n    if (attr_value === undefined) {\n      const default_value = this.default_value\n      if (default_value !== undefined)\n        attr_value = default_value(obj)\n      else\n        attr_value = null\n      obj.setv({[attr]: attr_value}, {silent: true, defaults: true})\n    }\n\n    if (isArray(attr_value))\n      this.spec = {value: attr_value}\n    else if (isSpec(attr_value))\n      this.spec = attr_value\n    else\n      this.spec = {value: attr_value}\n\n    if (this.spec.field != null && !isString(this.spec.field))\n      throw new Error(`field value for property '${attr}' is not a string`)\n\n    if (this.spec.value != null)\n      this.validate(this.spec.value)\n\n    this.init()\n  }\n\n  toString(): string {\n    /*${this.name}*/\n    return `Prop(${this.obj}.${this.attr}, spec: ${valueToString(this.spec)})`\n  }\n}\n\nProperty.prototype.dataspec = false\n\n//\n// Simple Properties\n//\n\nexport function simple_prop<T>(name: string, pred: (value: any) => boolean) {\n  return class extends Property<T> {\n    validate(value: any): void {\n      if (!pred(value))\n        throw new Error(`${name} property '${this.attr}' given invalid value: ${valueToString(value)}`)\n    }\n  }\n}\n\nexport class Any extends simple_prop(\"Any\", (_x) => true) {}\n\nexport class Array extends simple_prop(\"Array\", (x) => isArray(x) || x instanceof Float64Array) {}\n\nexport class Bool extends simple_prop(\"Bool\", isBoolean) {}\nexport const Boolean = Bool\n\nexport class Color extends simple_prop(\"Color\", (x) => is_svg_color(x.toLowerCase()) || x.substring(0, 1) == \"#\" || valid_rgb(x)) {}\n\nexport class Instance extends simple_prop(\"Instance\", (x) => x.properties != null) {}\n\n// TODO (bev) separate booleans?\nexport class Number extends simple_prop(\"Number\", (x) => isNumber(x) || isBoolean(x)) {}\nexport const Int = Number\n\n// TODO extend Number instead of copying it's predicate\n//class Percent extends Number(\"Percent\", (x) -> 0 <= x <= 1.0)\nexport class Percent extends simple_prop(\"Number\", (x) => (isNumber(x) || isBoolean(x)) && 0 <= x && x <= 1.0) {}\n\nexport class String extends simple_prop(\"String\", isString) {}\n\n// TODO (bev) don't think this exists python side\nexport class Font extends String {}\n\n\n//\n// Enum properties\n//\n\nexport function enum_prop<T>(name: string, enum_values: T[]) {\n  return class extends simple_prop(name, (x) => includes(enum_values, x)) {}\n}\n\nexport class Anchor extends enum_prop(\"Anchor\", enums.LegendLocation) {}\n\nexport class AngleUnits extends enum_prop(\"AngleUnits\", enums.AngleUnits) {}\n\nexport class Direction extends enum_prop(\"Direction\", enums.Direction) {\n  transform(values: any): any {\n    const result = new Uint8Array(values.length)\n    for (let i = 0; i < values.length; i++) {\n      switch (values[i]) {\n        case \"clock\":     result[i] = 0; break\n        case \"anticlock\": result[i] = 1; break\n      }\n    }\n    return result\n  }\n}\n\nexport class Dimension extends enum_prop(\"Dimension\", enums.Dimension) {}\n\nexport class Dimensions extends enum_prop(\"Dimensions\", enums.Dimensions) {}\n\nexport class FontStyle extends enum_prop(\"FontStyle\", enums.FontStyle) {}\n\nexport class LatLon extends enum_prop(\"LatLon\", enums.LatLon) {}\n\nexport class LineCap extends enum_prop(\"LineCap\", enums.LineCap) {}\n\nexport class LineJoin extends enum_prop(\"LineJoin\", enums.LineJoin) {}\n\nexport class LegendLocation extends enum_prop(\"LegendLocation\", enums.LegendLocation) {}\n\nexport class Location extends enum_prop(\"Location\", enums.Location) {}\n\nexport class OutputBackend extends enum_prop(\"OutputBackend\", enums.OutputBackend) {}\n\nexport class Orientation extends enum_prop(\"Orientation\", enums.Orientation) {}\n\nexport class VerticalAlign extends enum_prop(\"VerticalAlign\", enums.VerticalAlign) {}\n\nexport class TextAlign extends enum_prop(\"TextAlign\", enums.TextAlign) {}\n\nexport class TextBaseline extends enum_prop(\"TextBaseline\", enums.TextBaseline) {}\n\nexport class RenderLevel extends enum_prop(\"RenderLevel\", enums.RenderLevel) {}\n\nexport class RenderMode extends enum_prop(\"RenderMode\", enums.RenderMode) {}\n\nexport class SizingMode extends enum_prop(\"SizingMode\", enums.SizingMode) {}\n\nexport class SpatialUnits extends enum_prop(\"SpatialUnits\", enums.SpatialUnits) {}\n\nexport class Distribution extends enum_prop(\"Distribution\", enums.Distribution) {}\n\nexport class StepMode extends enum_prop(\"StepMode\", enums.StepMode) {}\n\nexport class PaddingUnits extends enum_prop(\"PaddingUnits\", enums.PaddingUnits) {}\n\nexport class StartEnd extends enum_prop(\"StartEnd\", enums.StartEnd) {}\n\n//\n// Units Properties\n//\nexport function units_prop<Units>(name: string, valid_units: Units[], default_units: any) {\n  return class extends Number {\n    init(): void {\n      if (this.spec.units == null)\n        this.spec.units = default_units\n\n      const units = this.spec.units\n      if (!includes(valid_units, units))\n        throw new Error(`${name} units must be one of ${valid_units}, given invalid value: ${units}`)\n    }\n\n    get units(): Units {\n      return this.spec.units as Units\n    }\n\n    set units(units: Units) {\n      this.spec.units = units\n    }\n  }\n}\n\nexport class Angle extends units_prop(\"Angle\", enums.AngleUnits, \"rad\") {\n  transform(values: Arrayable): Arrayable {\n    if (this.spec.units == \"deg\")\n      values = map(values, (x: number) => x * Math.PI/180.0)\n    values = map(values, (x: number) => -x)\n    return super.transform(values)\n  }\n}\n\nexport class Distance extends units_prop(\"Distance\", enums.SpatialUnits, \"data\") {}\n\n//\n// DataSpec properties\n//\n\nexport class AngleSpec extends Angle {}\nAngleSpec.prototype.dataspec = true\n\nexport class ColorSpec extends Color {}\nColorSpec.prototype.dataspec = true\n\nexport class DistanceSpec extends Distance {}\nDistanceSpec.prototype.dataspec = true\n\nexport class FontSizeSpec extends String {}\nFontSizeSpec.prototype.dataspec = true\n\nexport class NumberSpec extends Number {}\nNumberSpec.prototype.dataspec = true\n\nexport class StringSpec extends String {}\nStringSpec.prototype.dataspec = true\n"]}
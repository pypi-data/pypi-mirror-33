{"version":3,"sources":["models/callbacks/customjs.ts"],"names":[],"mappings":";;;AAAA,uCAAmC;AACnC,mCAAoC;AACpC,2CAA6C;AAC7C,2CAA2C;AAc3C;IAA8B,oCAAQ;IAIpC,kBAAY,KAA+B;eACzC,kBAAM,KAAK,CAAC;IACd,CAAC;IAEM,kBAAS,GAAhB;QACE,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,UAAU,CAAA;QAEhC,IAAI,CAAC,MAAM,CAAC;YACV,IAAI,EAAQ,CAAE,CAAC,CAAC,GAAG,EAAM,EAAE,CAAK;YAChC,IAAI,EAAQ,CAAE,CAAC,CAAC,MAAM,EAAG,EAAE,CAAK;YAChC,UAAU,EAAE,CAAE,CAAC,CAAC,OAAO,EAAE,KAAK,CAAE;SACjC,CAAC,CAAA;IACJ,CAAC;IAED,sBAAI,2BAAK;aAAT;YACE,OAAO,aAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;QACxB,CAAC;;;OAAA;IAED,sBAAI,4BAAM;aAAV;YACE,OAAO,eAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;QAC1B,CAAC;;;OAAA;IAED,sBAAI,0BAAI;aAAR;YACE,IAAM,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,mBAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAA;YAChE,YAAW,QAAQ,YAAR,QAAQ,kBAAI,IAAI,CAAC,KAAK,GAAE,QAAQ,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,IAAI,OAAC;QACrF,CAAC;;;OAAA;IAED,0BAAO,GAAP,UAAQ,MAAW,EAAE,OAA6B;QAChD,OAAO,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,EAAE,CAAC,CAAC,CAAA;IAClF,CAAC;IACH,eAAC;AAAD,CAlCA,AAkCC,CAlC6B,mBAAQ,GAkCrC;AAlCY,4BAAQ;AAmCrB,QAAQ,CAAC,SAAS,EAAE,CAAA","file":"customjs.js","sourcesContent":["import {Callback} from \"./callback\"\nimport * as p from \"core/properties\"\nimport {keys, values} from \"core/util/object\"\nimport {use_strict} from \"core/util/string\"\n\nexport namespace CustomJS {\n  export interface Attrs extends Callback.Attrs {\n    args: {[key: string]: any}\n    code: string\n    use_strict: boolean\n  }\n\n  export interface Props extends Callback.Props {}\n}\n\nexport interface CustomJS extends CustomJS.Attrs {}\n\nexport class CustomJS extends Callback {\n\n  properties: CustomJS.Props\n\n  constructor(attrs?: Partial<CustomJS.Attrs>) {\n    super(attrs)\n  }\n\n  static initClass(): void {\n    this.prototype.type = 'CustomJS'\n\n    this.define({\n      args:       [ p.Any,     {}    ], // TODO (bev) better type\n      code:       [ p.String,  ''    ],\n      use_strict: [ p.Boolean, false ],\n    })\n  }\n\n  get names(): string[] {\n    return keys(this.args)\n  }\n\n  get values(): any[] {\n    return values(this.args)\n  }\n\n  get func(): Function {\n    const code = this.use_strict ? use_strict(this.code) : this.code\n    return new Function(...this.names, \"cb_obj\", \"cb_data\", \"require\", \"exports\", code)\n  }\n\n  execute(cb_obj: any, cb_data: {[key: string]: any}): any {\n    return this.func.apply(cb_obj, this.values.concat(cb_obj, cb_data, require, {}))\n  }\n}\nCustomJS.initClass()\n"]}
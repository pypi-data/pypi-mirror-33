{"version":3,"sources":["models/widgets/dropdown.ts"],"names":[],"mappings":"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","file":"dropdown.js","sourcesContent":["import {span, ul, li, a} from \"core/dom\"\nimport {clear_menus} from \"core/menus\"\nimport * as p from \"core/properties\"\n\nimport {AbstractButton, AbstractButtonView} from \"./abstract_button\"\n\nexport class DropdownView extends AbstractButtonView {\n  model: Dropdown\n\n  connect_signals(): void {\n    super.connect_signals()\n    clear_menus.connect(() => this._clear_menu())\n  }\n\n  render(): void {\n    super.render()\n\n    if (!this.model.is_split_button) {\n      this.el.classList.add(\"bk-bs-dropdown\")\n      this.buttonEl.classList.add(\"bk-bs-dropdown-toggle\")\n      this.buttonEl.appendChild(span({class: \"bk-bs-caret\"}))\n    } else {\n      this.el.classList.add(\"bk-bs-btn-group\")\n      const caretEl = this._render_button(span({class: \"bk-bs-caret\"}))\n      caretEl.classList.add(\"bk-bs-dropdown-toggle\")\n      caretEl.addEventListener(\"click\", (event) => this._caret_click(event))\n      this.el.appendChild(caretEl)\n    }\n\n    if (this.model.active)\n      this.el.classList.add(\"bk-bs-open\")\n\n    const items = []\n    for (const item of this.model.menu) {\n      let itemEl: HTMLElement\n      if (item != null) {\n        const [label, value] = item\n        const link = a({}, label)\n        link.dataset.value = value\n        link.addEventListener(\"click\", (event) => this._item_click(event))\n        itemEl = li({}, link)\n      } else\n        itemEl = li({class: \"bk-bs-divider\"})\n      items.push(itemEl)\n    }\n\n    const menuEl = ul({class: \"bk-bs-dropdown-menu\"}, items)\n    this.el.appendChild(menuEl)\n  }\n\n  protected _clear_menu(): void {\n    this.model.active = false\n  }\n\n  protected _toggle_menu(): void {\n    const active = this.model.active\n    clear_menus.emit()\n    if (!active)\n      this.model.active = true\n  }\n\n  protected _button_click(event: MouseEvent): void {\n    event.preventDefault()\n    event.stopPropagation()\n\n    if (!this.model.is_split_button)\n      this._toggle_menu()\n    else {\n      this._clear_menu()\n      this.set_value(this.model.default_value)\n    }\n  }\n\n  protected _caret_click(event: MouseEvent): void {\n    event.preventDefault()\n    event.stopPropagation()\n    this._toggle_menu()\n  }\n\n  protected _item_click(event: MouseEvent): void {\n    event.preventDefault()\n    this._clear_menu()\n    this.set_value((event.currentTarget as HTMLElement).dataset.value!)\n  }\n\n  set_value(value: string): void {\n    this.buttonEl.value = this.model.value = value\n    this.change_input()\n  }\n}\n\nexport namespace Dropdown {\n  export interface Attrs extends AbstractButton.Attrs {\n    value: string\n    default_value: string\n    menu: ([string, string] | null)[]\n  }\n\n  export interface Props extends AbstractButton.Props {}\n}\n\nexport interface Dropdown extends Dropdown.Attrs {\n  active: boolean\n}\n\nexport class Dropdown extends AbstractButton {\n\n  properties: Dropdown.Props\n\n  constructor(attrs?: Partial<Dropdown.Attrs>) {\n    super(attrs)\n  }\n\n  static initClass(): void {\n    this.prototype.type = \"Dropdown\"\n    this.prototype.default_view = DropdownView\n\n    this.define({\n      value:         [ p.String    ],\n      default_value: [ p.String    ],\n      menu:          [ p.Array, [] ],\n    })\n\n    this.override({\n      label: \"Dropdown\",\n    })\n\n    this.internal({\n      active: [p.Boolean, false],\n    })\n  }\n\n  get is_split_button(): boolean {\n    return this.default_value != null\n  }\n}\n\nDropdown.initClass()\n"]}
{"version":3,"sources":["core/util/text.ts"],"names":[],"mappings":";;AAAA,8BAAwC;AAExC,IAAM,KAAK,GAAiC,EAAE,CAAA;AAQ9C,yBAAgC,IAAY;IAC1C,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,IAAI;QACrB,OAAO,KAAK,CAAC,IAAI,CAAC,CAAA;IAEpB,IAAM,IAAI,GAAG,UAAI,CAAC,EAAC,KAAK,EAAE,EAAC,IAAI,EAAE,IAAI,EAAC,EAAC,EAAE,IAAI,CAAC,CAAA;IAC9C,IAAM,KAAK,GAAG,SAAG,CAAC,EAAC,KAAK,EAAE,EAAC,OAAO,EAAE,cAAc,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAC,EAAC,CAAC,CAAA;IAElF,IAAM,IAAI,GAAG,SAAG,CAAC,EAAE,EAAE,IAAI,EAAE,KAAK,CAAC,CAAA;IACjC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAA;IAE/B,IAAI;QACF,KAAK,CAAC,KAAK,CAAC,aAAa,GAAG,UAAU,CAAA;QACtC,IAAM,MAAM,GAAG,YAAM,CAAC,KAAK,CAAC,CAAC,GAAG,GAAG,YAAM,CAAC,IAAI,CAAC,CAAC,GAAG,CAAA;QAEnD,KAAK,CAAC,KAAK,CAAC,aAAa,GAAG,QAAQ,CAAA;QACpC,IAAM,MAAM,GAAG,YAAM,CAAC,KAAK,CAAC,CAAC,GAAG,GAAG,YAAM,CAAC,IAAI,CAAC,CAAC,GAAG,CAAA;QAEnD,IAAM,MAAM,GAAG,EAAC,MAAM,QAAA,EAAE,MAAM,QAAA,EAAE,OAAO,EAAE,MAAM,GAAG,MAAM,EAAC,CAAA;QACzD,KAAK,CAAC,IAAI,CAAC,GAAG,MAAM,CAAA;QAEpB,OAAO,MAAM,CAAA;KACd;YAAS;QACR,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAA;KAChC;AACH,CAAC;AAxBD,0CAwBC","file":"text.js","sourcesContent":["import {div, span, offset} from \"../dom\"\n\nconst cache: {[key: string]: TextMetrics} = {}\n\nexport interface TextMetrics {\n  height: number\n  ascent: number\n  descent: number\n}\n\nexport function get_text_height(font: string): TextMetrics {\n  if (cache[font] != null)\n    return cache[font]\n\n  const text = span({style: {font: font}}, \"Hg\")\n  const block = div({style: {display: \"inline-block\", width: \"1px\", height: \"0px\"}})\n\n  const elem = div({}, text, block)\n  document.body.appendChild(elem)\n\n  try {\n    block.style.verticalAlign = \"baseline\"\n    const ascent = offset(block).top - offset(text).top\n\n    block.style.verticalAlign = \"bottom\"\n    const height = offset(block).top - offset(text).top\n\n    const result = {height, ascent, descent: height - ascent}\n    cache[font] = result\n\n    return result\n  } finally {\n    document.body.removeChild(elem)\n  }\n}\n"]}
{"version":3,"sources":["core/util/bbox.ts"],"names":[],"mappings":"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","file":"bbox.js","sourcesContent":["import {Rect} from \"./spatial\"\n\nconst {min, max} = Math\n\nexport function empty(): Rect {\n  return {\n    minX:  Infinity,\n    minY:  Infinity,\n    maxX: -Infinity,\n    maxY: -Infinity,\n  }\n}\n\nexport function positive_x(): Rect {\n  return {\n    minX:  Number.MIN_VALUE,\n    minY: -Infinity,\n    maxX:  Infinity,\n    maxY:  Infinity,\n  }\n}\n\nexport function positive_y(): Rect {\n  return {\n    minX: -Infinity,\n    minY:  Number.MIN_VALUE,\n    maxX:  Infinity,\n    maxY:  Infinity,\n  }\n}\n\nexport function union(a: Rect, b: Rect): Rect {\n  return {\n    minX: min(a.minX, b.minX),\n    maxX: max(a.maxX, b.maxX),\n    minY: min(a.minY, b.minY),\n    maxY: max(a.maxY, b.maxY),\n  }\n}\n\nexport interface IBBox {\n  x0: number\n  y0: number\n  x1: number\n  y1: number\n}\n\nexport interface IRect {\n  x: number\n  y: number\n  width: number\n  height: number\n}\n\nexport interface IRange {\n  start: number\n  end: number\n}\n\nexport class BBox implements IBBox {\n\n  readonly x0: number\n  readonly y0: number\n  readonly x1: number\n  readonly y1: number\n\n  constructor(box: IBBox | IRect) {\n    if ('x0' in box && 'y0' in box && 'x1' in box && 'y1' in box) {\n      const {x0, y0, x1, y1} = box as IBBox\n      if (!(x0 <= x1 && y0 <= y1))\n        throw new Error(`invalid bbox {x0: ${x0}, y0: ${y0}, x1: ${x1}, y1: ${y1}}`)\n      this.x0 = x0\n      this.y0 = y0\n      this.x1 = x1\n      this.y1 = y1\n    } else {\n      const {x, y, width, height} = box as IRect\n      if (!(width >= 0 && height >= 0))\n        throw new Error(`invalid bbox {x: ${x}, y: ${y}, width: ${width}, height: ${height}}`)\n      this.x0 = x\n      this.y0 = y\n      this.x1 = x + width\n      this.y1 = y + height\n    }\n  }\n\n  get minX(): number { return this.x0 }\n  get minY(): number { return this.y0 }\n  get maxX(): number { return this.x1 }\n  get maxY(): number { return this.y1 }\n\n  get left(): number { return this.x0 }\n  get top(): number { return this.y0 }\n  get right(): number { return this.x1 }\n  get bottom(): number { return this.y1 }\n\n  get p0(): [number, number] { return [this.x0, this.y0] }\n  get p1(): [number, number] { return [this.x1, this.y1] }\n\n  get x(): number { return this.x0 }\n  get y(): number { return this.y0 }\n  get width(): number { return this.x1 - this.x0 }\n  get height(): number { return this.y1 - this.y0 }\n\n  get rect(): IRect { return {x: this.x, y: this.y, width: this.width, height: this.height} }\n\n  get h_range(): IRange { return {start: this.x0, end: this.x1} }\n  get v_range(): IRange { return {start: this.y0, end: this.y1} }\n\n  get ranges(): [IRange, IRange] { return [this.h_range, this.v_range] }\n\n  get aspect(): number { return this.width/this.height }\n\n  contains(x: number, y: number): boolean {\n    return x >= this.x0 && x <= this.x1 && y >= this.y0 && y <= this.y1\n  }\n\n  clip(x: number, y: number): [number, number] {\n    if (x < this.x0)\n      x = this.x0\n    else if (x > this.x1)\n      x = this.x1\n\n    if (y < this.y0)\n      y = this.y0\n    else if (y > this.y1)\n      y = this.y1\n\n    return [x, y]\n  }\n\n  union(that: IBBox): BBox {\n    return new BBox({\n      x0: min(this.x0, that.x0),\n      y0: min(this.y0, that.y0),\n      x1: max(this.x1, that.x1),\n      y1: max(this.y1, that.y1),\n    })\n  }\n}\n"]}
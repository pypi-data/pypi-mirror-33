{"version":3,"sources":["core/layout/layout_canvas.ts"],"names":[],"mappings":"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","file":"layout_canvas.js","sourcesContent":["import {GE, EQ, Variable, Constraint} from \"./solver\"\nimport {HasProps} from \"../has_props\"\nimport {Arrayable} from \"../types\"\nimport {BBox} from \"../util/bbox\"\n\nexport interface ViewTransform {\n  compute: (v: number) => number\n  v_compute: (vv: Arrayable<number>) => Arrayable<number>\n}\n\nexport namespace LayoutCanvas {\n  export interface Attrs extends HasProps.Attrs {}\n\n  export interface Props extends HasProps.Props {}\n}\n\nexport interface LayoutCanvas extends LayoutCanvas.Attrs {}\n\nexport abstract class LayoutCanvas extends HasProps {\n\n  properties: LayoutCanvas.Props\n\n  constructor(attrs?: Partial<LayoutCanvas.Attrs>) {\n    super(attrs)\n  }\n\n  static initClass(): void {\n    this.prototype.type = \"LayoutCanvas\"\n  }\n\n  _top: Variable\n  _left: Variable\n  _width: Variable\n  _height: Variable\n  _right: Variable\n  _bottom: Variable\n  _hcenter: Variable\n  _vcenter: Variable\n\n  initialize(): void {\n    super.initialize()\n    this._top = new Variable(`${this.toString()}.top`)\n    this._left = new Variable(`${this.toString()}.left`)\n    this._width = new Variable(`${this.toString()}.width`)\n    this._height = new Variable(`${this.toString()}.height`)\n    this._right = new Variable(`${this.toString()}.right`)\n    this._bottom = new Variable(`${this.toString()}.bottom`)\n    this._hcenter = new Variable(`${this.toString()}.hcenter`)\n    this._vcenter = new Variable(`${this.toString()}.vcenter`)\n  }\n\n  get_editables(): Variable[] {\n    return []\n  }\n\n  get_constraints(): Constraint[] {\n    return [\n      GE(this._top),\n      GE(this._bottom),\n      GE(this._left),\n      GE(this._right),\n      GE(this._width),\n      GE(this._height),\n      EQ(this._left, this._width, [-1, this._right]),\n      EQ(this._top, this._height, [-1, this._bottom]),\n      EQ([2, this._hcenter], [-1, this._left], [-1, this._right]),\n      EQ([2, this._vcenter], [-1, this._top], [-1, this._bottom]),\n    ]\n  }\n\n  get_layoutable_children(): LayoutCanvas[] {\n    return []\n  }\n\n  get bbox(): BBox {\n    return new BBox({\n      x0: this._left.value,  y0: this._top.value,\n      x1: this._right.value, y1: this._bottom.value,\n    })\n  }\n\n  get layout_bbox(): {[key: string]: number} {\n    return {\n      top: this._top.value,\n      left: this._left.value,\n      width: this._width.value,\n      height: this._height.value,\n      right: this._right.value,\n      bottom: this._bottom.value,\n      hcenter: this._hcenter.value,\n      vcenter: this._vcenter.value,\n    }\n  }\n\n  get xview(): ViewTransform {\n    return {\n      compute: (x: number): number => {\n        return this._left.value + x\n      },\n      v_compute: (xx: Arrayable<number>): Arrayable<number> => {\n        const _xx = new Float64Array(xx.length)\n        const left = this._left.value\n        for (let i = 0; i < xx.length; i++) {\n          _xx[i] = left + xx[i]\n        }\n        return _xx\n      },\n    }\n  }\n\n  get yview(): ViewTransform {\n    return {\n      compute: (y: number): number => {\n        return this._bottom.value - y\n      },\n      v_compute: (yy: Arrayable<number>): Arrayable<number> => {\n        const _yy = new Float64Array(yy.length)\n        const bottom = this._bottom.value\n        for (let i = 0; i < yy.length; i++) {\n          _yy[i] = bottom - yy[i]\n        }\n        return _yy\n      },\n    }\n  }\n}\nLayoutCanvas.initClass()\n"]}